<!doctype html>
<html lang="en">
	<head>
		<!-- Required meta tags -->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<!-- Bootstrap CSS -->
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
		<!-- MAIN CSS -->
		<link rel="stylesheet" href="main.css">

		<!-- Bootstrap JS  -->
		<!-- Optional JavaScript -->
		<!-- jQuery first, then Popper.js, then Bootstrap JS -->
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
		<!-- Chart.js -->	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>

		<title>PROJECT MANAGER</title>
		
		<!-- Scripts -->
		<!-- NOTA: Cuidado, podria usarse tanto id's como name's, name's es el apropiado para forms pero solo aplica si usamos submit. -->
		<script src="scripts/PP.js"></script>
		<script src="scripts/PSM.js"></script>
		<script src="scripts/NPV.js"></script>
		<script src="scripts/Depreciation.js"></script>

	</head>
	<!-- <body class="p-3 mb-2 bg-light text-dark"> -->
	<body class="p-3 bg-light">
	<div  class="mx-auto" style="width: 80%;">
		<h1 align="center">Tecnológico de Monterrey - Campus Toluca</h1>
		<!-- Pepe Part. Merge Conflict. <img src="images/itesm.png" height="200" width="200" align="right"><br><br>-->
		<img src="images/itesm.png" height="150" width="150"><br><br>
		<h3 style="font-size:20px" align="right">Nombre/Número de proyecto: <form align="right"> <input type="text" onchange="document.getElementById('hiddenTitle').value = this.value;"> </form></h3>
		<h3 style="font-size:20px" align="right">Nombre Evaluador: <form align="right"> <input type="text" onchange="document.getElementById('hiddenUser').value = this.value;"> </form></h3>
		<h3>Materia: </h3> <h4>Evaluación y administración de proyectos TI2011 AD2018</h4> <br>
    
		<h3>Proyecto: </h3> <h4>Portfolio Evaluation Tool</h4><br>
		<h5 align="right">María J. Mirafuentes Gutiérrez - A01362149<br>
		Víctor E. Martín Del Campo Casas - A01362306<br>
		José F. Carbajal Bernal - A01365938<br>
		Joyce A. Choca Carrillo - A01366252<br>
		Edgar D. Rojas Vázquez - A01366307</h5><br>
	<!-- METHOD BAR-->
		<!-- <div class="card-header"> -->
			<ul class="nav nav-pills nav-justified" id="pills-tab" role="tablist">
				<li class="nav-item">
					<a class="nav-link active btn btn-primary btn-lg" id="pills-1-PP-tab" data-toggle="pill" href="#pills-1-PP" role="tab" aria-controls="pills-1-PP" aria-selected="true">Payback Period</a>
				</li>
				<li class="nav-item">
					<a class="nav-link btn btn-primary btn-lg" id="pills-2-NPV-tab" data-toggle="pill" href="#pills-2-NPV" role="tab" aria-controls="pills-2-NPV" aria-selected="false">NPV</a>
				</li>
				<li class="nav-item">
					<a class="nav-link btn btn-primary btn-lg" id="pills-3-Checklist-tab" data-toggle="pill" href="#pills-3-Checklist" role="tab" aria-controls="pills-3-Checklist" aria-selected="false">Checklist</a>
				</li>
				<li class="nav-item">
					<a class="nav-link btn btn-primary btn-lg" id="pills-4-Depreciation-tab" data-toggle="pill" href="#pills-4-Depreciation" role="tab" aria-controls="pills-4-Depreciation" aria-selected="false">Depreciation</a>
				</li>
				<li class="nav-item">
					<a class="nav-link btn btn-primary btn-lg" id="pills-5-PSM-tab" data-toggle="pill" href="#pills-5-PSM" role="tab" aria-controls="pills-5-PSM" aria-selected="false" onclick="createTablePSM()">Project Screening Matrix</a>
				</li>
			</ul>
		<!-- </div> -->
	<!-- TABS -->
		<!-- 1. Method: Payback Period -->
		<div class="tab-content" id="pills-tabContent">
			<div class="tab-pane fade show active" id="pills-1-PP" role="tabpanel" aria-labelledby="pills-1-PP-tab">
				<br>
					<p class="text-justify">Method of evaluating investment opportunities and product development projects on the basis of the time taken to recoup the investment.</p>
					<!-- <h4 class="text-justify">Method of evaluating investment opportunities and product development projects on the basis of the time taken to recoup the investment.</h4>-->	
				<br>
				<form>
					<div class="form-group row">
						<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Periodos</label>
						<!-- INPUT de PERIODOS -->
						<div class="col-sm-5">
							<select class="form-control form-control-lg" id="vPeriod" onchange="generateTable(this.value)">
								<option value="0"> -- Select a number of Periods -- </option>
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5</option>
								<option value="6">6</option>
								<option value="7">7</option>
								<option value="8">8</option>
								<option value="9">9</option>
								<option value="10">10</option>
							</select>
						</div>
						<div class="col-sm-5">
							<input type="reset" class="btn btn-danger btn-lg btn-block" value="Limpiar Datos" onclick="generateTable();">
						</div>
					</div>

					<div class="form-group row">
						<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Principal</label>
						<!-- <div class="col-sm-10"> -->
						<div class="col-sm-5">
							<div class="input-group">
								<div class="input-group-prepend">
									<span class="input-group-text">$</span>
								</div>
								<!-- INPUT de PRINCIPAL -->
								<input type="number" min="1" class="form-control form-control-lg" id="vPrincipal"  aria-label="Amount (to the nearest dollar)">
							</div>
						</div>
						<div class="col-sm-5">
							<input type="button" class="btn btn-primary btn-lg" value="Calcular Payback Period" onclick="validateData();">
						</div>
					</div>
				  
					<div class="form-group row mb-4">
						<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Tasa de Interes (%)</label>
						<div class="col-sm-5">
							<!-- INPUT de TASA DE INTERES -->
							<div class="input-group">
								<input type="number" min="0" max="100" class="form-control form-control-lg" id="vTasa" placeholder="0 - 100%" aria-label="Amount (to the nearest tax)">
								<div class="input-group-prepend">
									<span class="input-group-text">%</span>
								</div>
							</div>
						</div>
				 	</div>
				</form>
				<!-- Aqui se entrega a errorPP -->
				<div id="errorPP">
				</div>
				<div id="divPP">
				<!-- Aqui se entrega a tablePP -->
					<table class="table table-bordered table-hover" id="tablePP">
					  <thead class="thead-dark">
						<tr>
						  <th scope="col"># Period</th>
						  <th scope="col">Inflows</th>
						  <th scope="col">Outflows</th>
						  <th scope="col">Cummulative Cashflow</th>
						</tr>
					</table>
				</div>
				<div id="canvasPP">	
					<canvas id="chartPP"></canvas>	
				</div>
			</div>
		<!-- 2. Method: NPV -->
			<div class="tab-pane fade" id="pills-2-NPV" role="tabpanel" aria-labelledby="pills-2-NPV-tab">
				<p> Technique that involves estimating future net cash flows of an investment, discounting those cash flows using a discount rate and then subtracting the net initial outlay from the present value of the net cash flows. </p>

				<form>
					<div class="form-group row">
						<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Periodos</label>
						<!-- INPUT de PERIODOS -->
						<div class="col-sm-5">
							<select class="custom-select" id="vPeriod2" onchange="generate_TableNPV(this.value)">
							<option value="0"> -- Select a number of Periods -- </option>
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5</option>
							<option value="6">6</option>
							<option value="7">7</option>
							<option value="8">8</option>
							<option value="9">9</option>
							<option value="10">10</option>
							</select>
						</div>
						<div class="col-sm-5">
							<input type="button" class="btn btn-primary btn-block" value="Calcular NPV" onclick="validateData2();">
						</div>
					</div>

				  <div class="form-group row">
						<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Principal</label>
						<!-- <div class="col-sm-10"> -->
						<div class="col-sm-5">
							<div class="input-group mb-3">
								<div class="input-group-prepend">
									<span class="input-group-text">$</span>
								</div>
								<!-- INPUT de PRINCIPAL -->
								<input type="number" min="1" class="form-control form-control-lg" id="vPrincipal2"  aria-label="Amount (to the nearest dollar)">
							</div>
						</div>
						<div class="col-sm-5">
							<input type="reset" class="btn btn-primary btn-block" value="Limpiar Datos" onclick="generate_TableNPV();">
						</div>
					</div>

				   <div class="form-group row">
					<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Tasa de Interes (%)</label>
					<div class="col-sm-4">
					<!-- INPUT de TASA DE INTERES -->
					  <input type="number" min="0" max="100" class="form-control form-control-lg" id="vTasa2" placeholder="0 - 100">
					</div>
				  </div>

				  <div class="form-group row">
					<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Tax Rate (%)</label>
					<div class="col-sm-4">
					<!-- INPUT de TASA DE INTERES -->
					  <input type="number" min="0" max="100" class="form-control form-control-lg" id="vTasaTax" placeholder="0 - 100">
					</div>
				  </div>

				<div class="form-group row">
				  <label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Salvage Value</label>
						<!-- <div class="col-sm-10"> -->
						<div class="col-sm-5">
							<div class="input-group mb-3">
								<div class="input-group-prepend">
									<span class="input-group-text">$</span>
								</div>
								<!-- INPUT de PRINCIPAL -->
								<input type="number" min="1" class="form-control form-control-lg" id="vSValue"  aria-label="Amount (to the nearest dollar)">
							</div>
						</div>
				 </div>


				<div class="form-group row">
				  <label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Period of Salvage Value</label>
						<!-- <div class="col-sm-10"> -->
						<div class="col-sm-5">
							<div class="input-group mb-3">
								<div class="input-group-prepend">
									<span class="input-group-text">#</span>
								</div>
								<!-- INPUT de PRINCIPAL -->
								<input type="number" min="1" class="form-control form-control-lg" id="vPeriodSV">
							</div>
						</div>
				</div>

				</form>
				<div id="errorNPV">
				</div>
				<div id="divNPV">
				<!-- Aqui se entrega a tableNPV -->
					<table class="table table-bordered table-hover" id="tableNPV">
					  <thead class="thead-dark">
						<tr>
						  <th scope="col"># Period</th>
						  <th scope="col">Inflows</th>
						  <th scope="col">OutFlows</th>
						  <th scope="col">Cashflow per period</th>
							<th scope="col">NPV per period</th>
						</tr>
					</table>
				</div>
				<div id="canvasNPV">
					<canvas id="chartNPV"></canvas>
				</div>
			</div>
    <!-- 3. Method: Checklist -->
		<div class="tab-pane fade" id="pills-3-Checklist" role="tabpanel" aria-labelledby="pills-3-Checklist-tab">
				<br>
			<p>List of questions to review potential projects and determine their acceptance or rejections.</p>
			<form action="exportPDF.php" target="_blank" method="post">
			<table class="table">
				<thead class="thead-dark">
				<tr>
					<th scope="col">Topic</th>
					<th scope="col">Question</th>
					<th scope="col">Answer</th>
				</tr>
				</thead>
				<tbody>
				<tr>
					<th scope="row">Strategy/alignment</th>
					<td>What specific organization strategy does this project align with?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Driver</th>
					<td>What business problem does the project solve?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Success metrics</th>
					<td>How will the project measure success?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Sponsorship</th>
					<td>Who is the project sponsor?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Risk</th>
					<td>What is the impact of not doing this project?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Risk</th>
					<td>What is the project risk to our organization?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Risk</th>
					<td>Where does the proposed project fit in our risk profile?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Benefits, value</th>
					<td>What is the value of the project organization?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Benefits, value</th>
					<td>When will the project shows result?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Objectives</th>
					<td>What are the project objectives?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Organization Culture</th>
					<td>Is our organization culture right for this type of project?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Resources</th>
					<td>Will internal resources be available for this project?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Approach</th>
					<td>Will we build or buy?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Schedule</th>
					<td>How long will this project take?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Schedule</th>
					<td>Is the timeline realistic?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Training/resources</th>
					<td>Will staff training be required?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Finance/portfolio</th>
					<td>What is the estimated cost of the project?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Portfolio</th>
					<td>Is this a new initiative or path of an existing initiative?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Portfolio</th>
					<td>How does this project interact with current projects?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				<tr>
					<th scope="row">Technology</th>
					<td>Is the technology available or new?</td>
					<td><input type="text" name="q[]" maxlength="90"></td>
				</tr>
				</tbody>
			</table>
				<input id="hiddenUser" value="" type="hidden" name="userCL">
				<input id="hiddenTitle" value="" type="hidden" name="titleCL">
				<input class="btn btn-success" type="Submit" name="Export" value="Export to PDF">
			</form>
				<br>
		</div>

    <!-- 4. Method: Depreciation -->
		<div class="tab-pane fade" id="pills-4-Depreciation" role="tabpanel" aria-labelledby="pills-4-Depreciation-tab">
				<br>
				<p>The decrease in the economic potential of an asset over its productive or useful life.</p>
			<form>
				<div class="form-group row">
						<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Depreciation Method</label>
		        <div class="col-sm-4">
		         <select class="custom-select" id="depMethod" onchange="Escogido();">
		          <option disabled selected value>---Select Depreciation Method---</option>
		          <option value="1">Straight-line Depreciation</option>
		          <option value="2">MACRS Depreciation</option>
		          </select>
		        </div>
						<div class="col-sm-3">
							<input type="button" class="btn btn-primary btn-block" value="Calcular Depreciation" onclick="valida();">
						</div>
						<div class="col-sm-3">
							<input type="button" class="btn btn-primary btn-block" value="Limpiar Datos" onclick="Limpiar();">
						</div>
					</div>
				</br>
			</form>
			<!--Este es para SL Method-->
			<form id="forma1">
				<div id="inputdata" style="display:none;">
					<h1>Straight-line Depreciation</h1>
					<div class="form-group row">
						<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Starting year</label>
						<div class="col-sm-5">
							<div class="input-group mb-3">
								<input type="number" min="1" class="form-control form-control-lg" id="dSYSL"  aria-label="Amount (to the nearest dollar)">
							</div>
						</div>
					</div>
					<div class="form-group row">
						<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Periodos</label>
						<div class="col-sm-5">
							<select class="custom-select" id="dPeriodSL" onchange="">
							<option value="1" selected>1</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5</option>
							<option value="6">6</option>
							<option value="7">7</option>
							<option value="8">8</option>
							<option value="9">9</option>
							<option value="10">10</option>
							</select>
						</div>
					</div>

					<!--Empieza principal-->
					<div class="form-group row">
						<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Principal</label>
						<div class="col-sm-5">
							<div class="input-group mb-3">
								<div class="input-group-prepend">
									<span class="input-group-text">$</span>
								</div>
								<!-- INPUT de PRINCIPAL -->
								<input type="number" min="1" class="form-control form-control-lg" id="dPrincipalSL"  aria-label="Amount (to the nearest dollar)">
							</div>
						</div>
					</div>
					<!--Empieza Rescue Value-->
					<div class="form-group row">
						<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Rescue Value</label>
						<div class="col-sm-5">
							<div class="input-group mb-3">
								<div class="input-group-prepend">
									<span class="input-group-text">$</span>
								</div>
								<!-- INPUT de RV -->
								<input type="number" min="1" class="form-control form-control-lg" id="dRV"  aria-label="Amount (to the nearest dollar)">
							</div>
						</div>
					</div>
					<div class="form-group row">
			  <label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Tax(%)</label>
			  <div class="col-sm-5">
			  <!-- INPUT de TASA DE INTERES -->
				<input type="number" min="0" max="100" class="form-control form-control-lg" id="dTax" placeholder="0 - 100">
			  </div>
			  </div>


				<!-- Aqui se entrega a errorPP -->
				<div id="errorSL">
				</div>
				<div id="divSL">
				<!-- Aqui se entrega a tablePP -->

				</div>
				</div>
			</form>
					<!--FIN SL Method.....
					...................................
					.
					.
					.
					.
					.
					.
					.
					.
					.

				-->
				<form id="forma2">
					<!--Este es para MACRS Method-->
					<div id="inputdata2" style="display:none;">
						<h1>MACRS Depreciation</h1>
						<div class="form-group row">
							<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Starting year</label>
							<div class="col-sm-5">
								<div class="input-group mb-3">
									<input type="number" min="1" class="form-control form-control-lg" id="dSYM"  aria-label="Amount (to the nearest dollar)">
								</div>
							</div>
						</div>
						<div class="form-group row">
							<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Category</label>
							<div class="col-sm-5">
							<select class="custom-select" id="dMPeriod" onchange="">
								<option value="3" selected>3</option>
								<option value="5">5</option>
								<option value="7">7</option>
								<option value="10">10</option>
								</select>
							</div>
						</div>
						<!--Empieza principal-->
						<div class="form-group row">
							<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Principal</label>
							<div class="col-sm-5">
								<div class="input-group mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">$</span>
									</div>
									<!-- INPUT de PRINCIPAL -->
									<input type="number" min="1" class="form-control form-control-lg" id="dMPrincipal"  aria-label="Amount (to the nearest dollar)">
								</div>
							</div>
						</div>
						<div class="form-group row">
							<label for="colFormLabelLg" class="col-sm-2 col-form-label col-form-label-lg">Tax(%)</label>
							<div class="col-sm-5">
								<!-- INPUT de TASA DE INTERES -->
								<input type="number" min="0" max="100" class="form-control form-control-lg" id="dMTax" placeholder="0 - 100">
							</div>
						 </div>
				
						<!-- Aqui se entrega a errorPP -->
						<div id="errorM">
						</div>
						<div id="divM">

						</div>
					</div>
				</form>
			</div>
		<!--FIN DEPRECIATION-->
		<!-- 5. Method: Project Screening Method -->
			<div class="tab-pane fade" id="pills-5-PSM" role="tabpanel" aria-labelledby="pills-5-PSM-tab">
				<br>
					<p> Por cuestiones de seguridad tanto del cliente  como del servidor, puede: </p>
				<br>
				<div class="form-group row">
					<div class="col-sm-2">
					</div>
					<div class="col-sm-4">
								<input type="button" class="btn btn-light btn-block border border-success text-success font-weight-bold" value="Descargar Excel" onclick="xls();">
					</div>
					<div class="col-sm-4">
								<input type="button" class="btn btn-primary btn-block" value="Descargar Excel" onclick="xls();">
					</div>
					<div class="col-sm-2">
					</div>
				</div>
				<!-- Aqui se entrega a tablePSM -->
				<div id="divPSM">
				</div>
			</div>
	</div>
	
	<br>
	<br>
	
	<br>
	<br>
	
	<br>
	<br>
	
	</body>
</html>
